{% extends 'layout.html' %}
{% load static %}
{% block css %}
    <link rel="stylesheet" type="text/css" href="{% static 'css/Chart.min.css' %}">
{% endblock css %}

{% block content %}
    <div class="hide_overflow_x width_99">


        <div class="row">
            <div class="col-lg-2 col-md-2 col-xs-12 col-sm-2">
                <div class="nav flex-column nav-pills" id="v-pills-tab" role="tablist" aria-orientation="vertical">
                    <a class="nav-link active" id="v-pills-home-tab" data-toggle="pill" href="#v-pills-home" role="tab"
                       aria-controls="v-pills-home" aria-selected="true">Economia</a>
                    <a class="nav-link" id="v-pills-profile-tab" data-toggle="pill" href="#v-pills-profile" role="tab"
                       aria-controls="v-pills-profile" aria-selected="false">Profile</a>
                    <a class="nav-link" id="v-pills-messages-tab" data-toggle="pill" href="#v-pills-messages" role="tab"
                       aria-controls="v-pills-messages" aria-selected="false">Messages</a>
                    <a class="nav-link" id="v-pills-settings-tab" data-toggle="pill" href="#v-pills-settings" role="tab"
                       aria-controls="v-pills-settings" aria-selected="false">Settings</a>
                </div>
            </div>
            <div class="col-lg-10 col-md-10 col-xs-12 col-sm-10">
                <div class="tab-content" id="v-pills-tabContent">
                    <div class="tab-pane fade show active" id="v-pills-home" role="tabpanel"
                         aria-labelledby="v-pills-home-tab">
                        {% include 'dashboard/partial/_home.html' %}
                    </div>
                    <div class="tab-pane fade" id="v-pills-profile" role="tabpanel"
                         aria-labelledby="v-pills-profile-tab">...
                    </div>
                    <div class="tab-pane fade" id="v-pills-messages" role="tabpanel"
                         aria-labelledby="v-pills-messages-tab">...
                    </div>
                    <div class="tab-pane fade" id="v-pills-settings" role="tabpanel"
                         aria-labelledby="v-pills-settings-tab">...
                    </div>
                </div>
            </div>
        </div>
        <input type="button" onclick="clic()" id="con" class="btn btn-outline-success btn-block" value="Hola">
    </div>
{% endblock %}

{% block js %}
    <script src="{% static 'js/Chart.bundle.min.js' %}"></script>
    <script>

      const socket = new WebSocket(
            'ws://'
            + window.location.host
            + '/ws/test/'
        );

        socket.onmessage = function(e) {
            const data = JSON.parse(e.data);
            document.getElementById('con').value = (data.value);
        };

        socket.onclose = function(e) {
            console.error('Chat socket closed unexpectedly');
            console.error(e.reason)
        };


        function clic() {
            socket.send(JSON.stringify({
                'value': Math.floor(Math.random() * 10)
            }))
        }


    </script>


    <script>

        var ctx = document.getElementById('firstChart').getContext('2d');
        var chart = new Chart(ctx, {
            type: 'doughnut',
            data: {
                labels: ['Entrada', 'Salida'],
                datasets: [{

                    data: [{{ entrada }}, {{ salida }}],
                    backgroundColor: [
                        'rgba(255, 99, 132, 0.2)',
                        'rgba(54, 162, 235, 0.2)',
                    ],
                    borderColor: [
                        'rgba(255, 99, 132, 1)',
                        'rgba(54, 162, 235, 1)',
                    ],
                    borderWidth: 1
                }]
            },
            options: {
                scales: {
                    yAxes: [{
                        stacked: true
                    }]
                },
                onresize: beforePrintHandler(),
                //responsive: false for manual resize
            }
        });

        chart.canvas.parentNode.style.minWidth = '200px';
        chart.canvas.parentNode.style.minHeight = '200px';


        var ctx = document.getElementById('secondChart').getContext('2d');
        var dataOBJ = {
            type: 'pie',
            data: {
                labels: ['Deudas Pendientes', 'Deudas Liquidadas'],
                datasets: [{
                    data: [{{ deudas_pendientes }}, {{ deudas_liquidadas }}],
                    backgroundColor: [
                        'rgba(255, 99, 132, 0.2)',
                        'rgba(54, 162, 235, 0.2)',
                    ],
                    borderColor: [
                        'rgba(255, 99, 132, 1)',
                        'rgba(54, 162, 235, 1)',
                    ],
                    borderWidth: 1
                }]
            },
            options: {
                scales: {
                    yAxes: [{
                        stacked: true
                    }]
                },
                onresize: beforePrintHandler(),
                //responsive: false for manual resize
            }
        }
        //var chart2 = new Chart(ctx, dataOBJ);
        window.myLiny = new Chart(ctx, dataOBJ);
        window.myLiny.canvas.parentNode.style.minWidth = '200px';
        window.myLiny.canvas.parentNode.style.minHeight = '200px';


        var ctx = document.getElementById('thirdChart').getContext('2d');
        var chart3 = new Chart(ctx, {
            type: 'bar',
            data: {
                labels: [{% for sal in salario %}'{{ sal.fecha_deposito }}',{% endfor %}],
                datasets: [{
                    label: "Salario",
                    data: [{% for sal in salario %}{{ sal.amount }}, {% endfor %}],
                    backgroundColor: [
                        {% for sal in salario %}
                            'rgba(255, 99, 132, 0.2)',
                        {% endfor %}


                    ],
                    borderColor: [
                        {% for sal in salario %}
                            'rgba(255, 99, 132, 0.2)',
                        {% endfor %}
                    ],
                    borderWidth: 3,
                },
                    {
                        label: "Salario",
                        data: [{% for sal in salario %}{{ sal.amount }}, {% endfor %}],

                        backgroundColor: [
                            {% for sal in salario %}
                                'black',
                            {% endfor %}


                        ],
                        borderColor: [
                            {% for sal in salario %}
                                'rgba(0, 0, 0, 1)',
                            {% endfor %}
                        ],
                        borderWidth: 4,

                        fill: 'origin',
                        type: 'line',
                    }]
            },
            options: {

                onresize: beforePrintHandler(),
                //responsive: false for manual resize
            }
        });

        chart3.canvas.parentNode.style.minWidth = '200px';
        chart3.canvas.parentNode.style.minHeight = '200px';


        function beforePrintHandler() {
            for (var id in Chart.instances) {
                Chart.instances[id].resize();
            }
        }

    </script>
{% endblock %}





